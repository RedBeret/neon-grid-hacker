import{j as e,g as O,h as _,i as I}from"./shadcn-ui-vendors-BGyadPNx.js";import{R as P,r as b}from"./lucide-icons-BZusxVGo.js";import{M as R}from"./MainLayout-BqW6GOzX.js";import{a as w,u as S,b as k,T as D,c as L,d as G,e as $}from"./index-D4D6jq4m.js";import{B as g}from"./button-BZVJMo9Z.js";const F=5,C=500,H=({id:s,x:a,y:i,color:h,onComplete:y})=>{const[d,c]=b.useState(!0);if(b.useEffect(()=>{const m=setTimeout(()=>{c(!1),y(s)},C);return()=>clearTimeout(m)},[s,y]),!d)return null;const x=Array.from({length:F}).map((m,u)=>{const p=Math.random()*4+2;return e.jsx("div",{className:"absolute rounded-full z-30",style:{left:a,top:i,width:`${p}px`,height:`${p}px`,backgroundColor:h,transform:"translate(-50%, -50%) scale(0)",animation:`particle-burst-anim ${C}ms ease-out forwards`,opacity:0}},u)});return e.jsx(e.Fragment,{children:x})},Y=P.memo(H),U={cyan:"#00eaff",magenta:"#ff2bff",yellow:"#f7ff00"},V=({onNodeClick:s})=>{const{state:a}=w();S();const{particlesEnabled:i}=k(),[h,y]=b.useState([]),d=b.useRef(),c=a.grid,x=(t,l)=>{const j=(t-l)*30,E=(t+l)*15;return{x:j+200,y:E+50}};b.useEffect(()=>{var n;if(!i||!d.current||!c){i||y([]),d.current=c;return}const t=c,l=d.current,r=[];for(let o=0;o<t.length;o++)for(let N=0;N<t[o].length;N++){const j=t[o][N],E=(n=l[o])==null?void 0:n[N];if(j.solved&&E&&!E.solved){const T=x(j.x,j.y),A=T.x+12,M=T.y+6;r.push({id:`particle-${j.id}-${Date.now()}`,x:A,y:M,color:U[j.color]||"#ffffff"})}}r.length>0&&y(o=>[...o,...r]),d.current=c},[c,i,a.status]);const m=t=>{y(l=>l.filter(r=>r.id!==t))},u=(t,l)=>{s(t,l)},p=t=>{const{x:l,y:r}=x(t.x,t.y);let n="";switch(t.color){case"cyan":n="bg-cyber-cyan/20 border-cyber-cyan hover:bg-cyber-cyan/30";break;case"magenta":n="bg-cyber-magenta/20 border-cyber-magenta hover:bg-cyber-magenta/30";break;case"yellow":n="bg-cyber-yellow/20 border-cyber-yellow hover:bg-cyber-yellow/30";break;default:n="bg-cyber-cyan/20 border-cyber-cyan hover:bg-cyber-cyan/30"}const o=t.solved?"opacity-50":"border-glow-"+t.color;return e.jsx("button",{className:`absolute w-12 h-6 ${n} ${o} transform rotate-45 cursor-cyber transition-all duration-300 hover:scale-105`,style:{left:`${l}px`,top:`${r}px`},disabled:t.solved||a.status!=="playing",onClick:()=>u(t.x,t.y),children:e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center -rotate-45 text-xs",children:[t.type==="loop"&&e.jsx("span",{className:"animate-spin",children:"⟳"}),t.type==="conditional"&&e.jsx("span",{className:"text-glow-cyan",children:t.solved?"T":"F"}),t.type==="recursion"&&e.jsx("span",{className:"animate-pulse",children:"⦿"})]})},t.id)},f=()=>{if(!a.player||a.grid.length===0)return null;const{x:t,y:l}=x(a.player.x,a.player.y);return e.jsx("div",{className:"absolute w-6 h-6 bg-white rounded-full animate-pulse-glow z-20",style:{left:`${t+3}px`,top:`${l-6}px`,boxShadow:"0 0 10px #00eaff, 0 0 15px #00eaff"}})},v=b.useMemo(()=>!c||c.length===0?null:c.flatMap(t=>t.map(l=>p(l))),[c,a.status]);return e.jsxs("div",{className:"relative w-full h-[60vh] overflow-hidden",children:[v,f(),h.map(t=>e.jsx(Y,{id:t.id,x:t.x,y:t.y,color:t.color,onComplete:m},t.id))]})},z=()=>{const{state:s}=w(),a=i=>{const h=Math.floor(i/60),y=Math.floor(i%60);return`${h.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"fixed top-0 left-0 w-full p-4 z-30 pointer-events-none",children:[e.jsxs("div",{className:"container mx-auto flex justify-between",children:[e.jsx("div",{className:"cyber-glass p-2 rounded border border-cyber-cyan/50 text-glow-cyan",children:e.jsx("div",{className:"text-cyber-cyan font-bold",children:a(s.timeRemaining)})}),e.jsx("div",{className:"cyber-glass p-2 rounded border border-cyber-magenta/50 text-glow-magenta",children:e.jsxs("div",{className:"text-cyber-magenta font-bold",children:["Score: ",Math.floor(s.score)]})})]}),e.jsx("div",{className:"fixed bottom-4 left-0 w-full flex justify-center",children:e.jsxs("div",{className:"cyber-glass p-2 rounded border border-cyber-yellow/50 text-glow-yellow flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-cyber-yellow text-sm",children:"Integrity:"}),e.jsx("div",{className:"w-32 h-3 bg-cyber-bg/70 border border-cyber-yellow/50",children:e.jsx("div",{className:"h-full bg-cyber-yellow/70",style:{width:`${s.player.integrity}%`}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-cyber-cyan text-sm",children:"Dash:"}),e.jsx("div",{className:"w-20 h-3 bg-cyber-bg/70 border border-cyber-cyan/50",children:e.jsx("div",{className:"h-full bg-cyber-cyan/70",style:{width:s.player.canDash?"100%":`${(3-s.player.dashCooldown)/3*100}%`}})})]}),e.jsxs("div",{className:"text-cyber-magenta text-sm",children:["Combo: x",s.combo.toFixed(1)]})]})})]})},B=()=>{const{state:s,dispatch:a}=w(),{playSfx:i}=S(),h=y=>{var u,p,f;if(s.status!=="playing")return;const{x:d,y:c}=s.player;let x=d,m=c;switch(y.key.toLowerCase()){case"w":case"arrowup":m=Math.max(0,c-1);break;case"a":case"arrowleft":x=Math.max(0,d-1);break;case"s":case"arrowdown":m=Math.min(s.grid.length-1,c+1);break;case"d":case"arrowright":x=Math.min(((u=s.grid[0])==null?void 0:u.length)-1||0,d+1);break;case" ":(p=s.grid[c])!=null&&p[d]&&!s.grid[c][d].solved&&(a({type:"SOLVE_NODE",x:d,y:c}),i("solve"));break;case"shift":if(s.player.canDash){a({type:"DASH"}),i("dash");const t=[{x:0,y:-1},{x:-1,y:0},{x:0,y:1},{x:1,y:0}].filter(l=>{var o;const r=d+l.x,n=c+l.y;return r>=0&&r<((o=s.grid[0])==null?void 0:o.length)&&n>=0&&n<s.grid.length});if(t.length>0){const l=t[Math.floor(Math.random()*t.length)];a({type:"MOVE_PLAYER",x:Math.min(Math.max(0,d+l.x*2),((f=s.grid[0])==null?void 0:f.length)-1||0),y:Math.min(Math.max(0,c+l.y*2),s.grid.length-1||0)})}}break}(x!==d||m!==c)&&(a({type:"MOVE_PLAYER",x,y:m}),i("click"))};return b.useEffect(()=>(window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}),[s.status,s.player.x,s.player.y,s.player.canDash,s.grid]),e.jsxs("div",{className:"mt-4 cyber-glass p-4 rounded-md border border-cyber-cyan/50",children:[e.jsx("h2",{className:"text-cyber-cyan mb-3 text-glow-cyan",children:"Controls"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white mb-1",children:"Movement:"}),e.jsx("p",{className:"text-cyber-cyan/70",children:"WASD / Arrow Keys"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white mb-1",children:"Interact:"}),e.jsx("p",{className:"text-cyber-cyan/70",children:"Space"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white mb-1",children:"Dash:"}),e.jsx("p",{className:"text-cyber-cyan/70",children:"Shift"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white mb-1",children:"Pause:"}),e.jsx("p",{className:"text-cyber-cyan/70",children:"Esc"})]})]})]})},K=O,X=_,W=I,q=({onClose:s})=>(w(),e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"cyber-glass p-6 border border-cyber-cyan/50 max-w-2xl w-full",children:[e.jsx("h2",{className:"text-3xl mb-6 text-cyber-cyan text-glow-cyan",children:"SYSTEM TUTORIAL"}),e.jsxs("div",{className:"space-y-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl text-cyber-yellow mb-2",children:"NODE TYPES"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"cyber-glass p-3 border border-cyber-cyan/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 flex items-center justify-center bg-cyber-cyan/20 border border-cyber-cyan",children:e.jsx("span",{className:"animate-spin",children:"⟳"})}),e.jsx("h4",{className:"text-cyber-cyan",children:"LOOPS"})]}),e.jsxs("p",{className:"text-sm",children:["Navigate to node and press ",e.jsx("span",{className:"text-cyber-yellow",children:"SPACE"})," to hack. Time your hacking when the loop completes its cycle."]})]}),e.jsxs("div",{className:"cyber-glass p-3 border border-cyber-magenta/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 flex items-center justify-center bg-cyber-magenta/20 border border-cyber-magenta",children:e.jsx("span",{className:"text-cyber-magenta",children:"F"})}),e.jsx("h4",{className:"text-cyber-magenta",children:"CONDITIONALS"})]}),e.jsxs("p",{className:"text-sm",children:["Navigate to node and press ",e.jsx("span",{className:"text-cyber-yellow",children:"SPACE"})," to toggle the condition from F to T (true) to complete the hack."]})]}),e.jsxs("div",{className:"cyber-glass p-3 border border-cyber-yellow/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 flex items-center justify-center bg-cyber-yellow/20 border border-cyber-yellow",children:e.jsx("span",{className:"animate-pulse",children:"⦿"})}),e.jsx("h4",{className:"text-cyber-yellow",children:"RECURSION"})]}),e.jsxs("p",{className:"text-sm",children:["These complex nodes require precise timing. Navigate to node and press ",e.jsx("span",{className:"text-cyber-yellow",children:"SPACE"})," during the pulse peak."]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl text-cyber-cyan mb-2",children:"CONTROLS"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Movement:"}),e.jsx("span",{className:"text-cyber-cyan",children:"WASD / Arrow Keys"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Hack Node:"}),e.jsx("span",{className:"text-cyber-cyan",children:"SPACE"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Dash:"}),e.jsx("span",{className:"text-cyber-cyan",children:"SHIFT"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Pause:"}),e.jsx("span",{className:"text-cyber-cyan",children:"ESC"})]})]})]}),e.jsxs(K,{children:[e.jsxs(X,{className:"text-xl text-cyber-magenta flex items-center gap-2 w-full justify-between",children:["SCORING SYSTEM",e.jsx("span",{className:"text-sm",children:"(Click to expand)"})]}),e.jsx(W,{className:"pt-2",children:e.jsxs("ul",{className:"space-y-1 text-sm list-disc list-inside",children:[e.jsx("li",{children:"+100 points for each hacked node"}),e.jsx("li",{children:"Combo multiplier increases by 0.1x for consecutive hacks"}),e.jsx("li",{children:"-10 points per second of inactivity"}),e.jsx("li",{children:"Unlock higher difficulties with 75%+ efficiency"})]})})]}),e.jsxs("div",{className:"p-3 border border-cyber-yellow/30 bg-cyber-yellow/10",children:[e.jsx("h4",{className:"text-cyber-yellow mb-1",children:"HACKER TIPS"}),e.jsx("p",{className:"text-sm",children:"Stay moving to avoid idle penalties. Use dash ability to quickly move across the grid. Prioritize nodes that match your hacking style."})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(D,{children:e.jsxs(L,{children:[e.jsx(G,{asChild:!0,children:e.jsx(g,{onClick:s,className:"bg-cyber-cyan hover:bg-cyber-cyan/80 text-black px-8",children:"START HACKING"})}),e.jsx($,{className:"border-cyber-cyan bg-black/80 text-cyber-cyan",children:"Press to close tutorial and begin"})]})})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-cyber-cyan/50",children:"Tutorial can be reviewed at any time from the pause menu."})})]})})),te=()=>{const{state:s,dispatch:a}=w(),{playSfx:i}=S(),{showTutorialOnStartup:h}=k(),[y,d]=b.useState(!1),[c,x]=b.useState(!1),m=r=>{a({type:"START_GAME",difficulty:r}),i("click"),x(h)},u=(r,n)=>{s.status==="playing"&&(a({type:"MOVE_PLAYER",x:r,y:n}),s.player.x===r&&s.player.y===n&&(a({type:"SOLVE_NODE",x:r,y:n}),i("solve")))};b.useEffect(()=>{const r=n=>{n.key==="Escape"&&s.status==="playing"&&(a({type:"PAUSE_GAME"}),i("click"))};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[s.status,a]);const p=()=>{switch(s.status){case"idle":return f();case"playing":return v();case"paused":return t();case"gameOver":return l();default:return f()}},f=()=>{const r=["easy","medium","hard","expert","master"];return e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("h2",{className:"text-3xl mb-8 text-cyber-cyan text-glow-cyan",children:"SELECT DIFFICULTY"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-md mb-8",children:r.map((n,o)=>e.jsx(g,{onClick:()=>m(n),className:`
                py-6
                ${o===0?"bg-emerald-600 hover:bg-emerald-700":""}
                ${o===1?"bg-blue-600 hover:bg-blue-700":""}
                ${o===2?"bg-amber-600 hover:bg-amber-700":""}
                ${o===3?"bg-orange-600 hover:bg-orange-700":""}
                ${o===4?"bg-red-600 hover:bg-red-700":""}
                text-white uppercase
              `,children:n},n))}),e.jsxs(g,{variant:"outline",onClick:()=>d(!y),className:"border-cyber-cyan text-cyber-cyan",children:[y?"Hide":"Show"," Controls"]}),y&&e.jsx(B,{})]})},v=()=>e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(V,{onNodeClick:u}),c&&e.jsx(q,{onClose:()=>x(!1)})]}),t=()=>e.jsxs("div",{className:"cyber-glass p-8 border border-cyber-cyan/50 max-w-md mx-auto",children:[e.jsx("h2",{className:"text-3xl mb-6 text-cyber-cyan text-glow-cyan",children:"PAUSED"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(g,{onClick:()=>{a({type:"RESUME_GAME"}),i("click")},className:"w-full bg-cyber-cyan hover:bg-cyber-cyan/80 text-black",children:"Resume Game"}),e.jsx(g,{variant:"outline",onClick:()=>x(!0),className:"w-full border-cyber-yellow text-cyber-yellow",children:"Show Tutorial"}),e.jsx(g,{variant:"outline",onClick:()=>{a({type:"END_GAME"}),i("click")},className:"w-full border-cyber-magenta text-cyber-magenta",children:"Quit Game"})]})]}),l=()=>{const r=Math.min(100,Math.round(s.score/1500*100));return e.jsxs("div",{className:"cyber-glass p-8 border border-cyber-cyan/50 max-w-md mx-auto",children:[e.jsx("h2",{className:"text-3xl mb-2 text-cyber-cyan text-glow-cyan",children:"SYSTEM BREACH TERMINATED"}),e.jsx("p",{className:"mb-6 text-cyber-yellow",children:"Connection lost"}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Difficulty:"}),e.jsx("span",{className:"text-cyber-cyan",children:s.difficulty.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Final Score:"}),e.jsx("span",{className:"text-cyber-magenta",children:Math.floor(s.score)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"High Score:"}),e.jsx("span",{className:"text-cyber-yellow",children:Math.floor(s.highScore)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Efficiency:"}),e.jsxs("span",{className:"text-cyber-cyan",children:[r,"%"]})]})]}),r>=75&&s.difficulty!=="master"&&e.jsx("div",{className:"mb-6 p-3 border border-cyber-yellow/50 bg-cyber-yellow/10",children:e.jsx("p",{className:"text-cyber-yellow",children:"New difficulty tier unlocked!"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(g,{onClick:()=>{a({type:"START_GAME",difficulty:s.difficulty}),i("click")},className:"w-full bg-cyber-cyan hover:bg-cyber-cyan/80 text-black",children:"Play Again"}),e.jsx(g,{variant:"outline",onClick:()=>{a({type:"END_GAME"}),i("click")},className:"w-full border-cyber-magenta text-cyber-magenta",children:"Back to Menu"})]})]})};return e.jsx(R,{hideNavigation:s.status==="playing",children:p()})};export{te as default};
